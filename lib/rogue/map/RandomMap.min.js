var __extends=this.__extends||function(n,t){function i(){this.constructor=n}i.prototype=t.prototype,n.prototype=new i},rogue;(function(n){(function(t){var i=function(i){function r(n){i.call(this),this.dirs=[{x:-1,y:0},{x:0,y:1},{x:1,y:0},{x:0,y:-1}],this.mapsize=n,this.tiles=[],this.randomMap(this.mapsize),this.genMaze(),this.genRooms(1,3)}return __extends(r,i),r.prototype.randomMap=function(n){var t,i,u,r;for(this.mapsize=n,this._width=this._height=n*2+3,this.paths=[],this._rooms=[],t=0;t<this._height;t++){for(i=[],u=[],r=0;r<this._width;r++)i.push("#"),u.push("0");this.tiles.push(i)}return this},r.prototype.genMaze=function(){var n=1,t=1,r,u;for(this.tiles[n][t]=" ";;){for(r=Math.floor(Math.random()*4),u=0;u<4;u++){var i=(r+u)%4,f=n+this.dirs[i].x*2,e=t+this.dirs[i].y*2;if(f>0&&f<this._width&&e>0&&e<this._height&&this.tiles[f][e]=="#")break}if(u<4)n+=this.dirs[i].x,t+=this.dirs[i].y,this.tiles[n][t]=" ",n+=this.dirs[i].x,t+=this.dirs[i].y,this.tiles[n][t]=""+i;else if(n==1&&t==1)break;else r=this.tiles[n][t],this.tiles[n][t]=" ",n-=this.dirs[r].x*2,t-=this.dirs[r].y*2}},r.prototype.genRooms=function(i,r){for(var s=0,u,f,e,o;;){if(s>10)break;var h=Math.floor(Math.random()*r)+i,c=Math.floor(Math.random()*r)+i,l=Math.floor(Math.random()*(this.mapsize-h))*2+1,a=Math.floor(Math.random()*(this.mapsize-c))*2+1,v=l+h*2,y=a+c*2;for(f=new t.Room(l,a,v,y),u=0;u<this._rooms.length;u++)if(f.intersects(this._rooms[u]))break;u==this._rooms.length?(this._rooms.push(f),s=0):s++}for(u=0;u<this._rooms.length;u++)for(f=this._rooms[u],e=f.x1;e<=f.x2;e++)for(o=f.y1;o<=f.y2;o++)this.tiles[e][o]=" ",this.openTiles.push(new n.geom.Point(e,o))},r}(t.TileMap);t.RandomMap=i})(n.map||(n.map={}));var t=n.map})(rogue||(rogue={}))