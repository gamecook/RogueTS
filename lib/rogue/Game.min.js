var rogue;(function(n){var t=function(){function t(t){this.display=t,this.input=new n.controls.Input,this.map=new n.map.RandomMap(21),this.populateMapHelper=new n.map.MapPopulater(this.map),this.populateMapHelper.populateMap(["x","x","x","x","x","x","x","x","x","x","x","x","x","x","x","x","x","x","x","x","x","x","x","x","x","x","x","x","x","x","x","x"]),this.movementHelper=new n.controls.MovementHelper(this.map),this.movementHelper.startPosition(this.populateMapHelper.getRandomEmptyPoint()),this.selection=new n.map.FogOfWarMapSelection(this.map,40,24,5),this.selection.setCenter(this.movementHelper.playerPosition),this.renderer=new n.renderer.CanvasMapRenderer(this.display,new n.geom.Rectangle(0,0,20,20)),console.log(this.map.toString()),this.onEnterFrame()}return t.prototype.onEnterFrame=function(){this.invalidate();var n=this,t=function(){n.render(),requestAnimationFrame(t)};t(n)},t.prototype.render=function(){if(this.input.state&&this.move(this.input.state),this.invalid){this.renderer.renderMap(this.selection);var n=this.movementHelper.playerPosition,t=n.x-this.selection.getOffsetX(),i=n.y-this.selection.getOffsetY();this.renderer.renderPlayer(t,i,"@"),this.invalid=!1}this.input.clear()},t.prototype.move=function(n){var t=this.movementHelper.previewMove(n),i;if(t!=null){i=this.map.getTileType(t);switch(i){case" ":case"x":this.movementHelper.move(t.x,t.y),this.selection.setCenter(this.movementHelper.playerPosition),this.invalidate()}}},t.prototype.invalidate=function(){this.invalid=!0},t}();n.Game=t})(rogue||(rogue={}))